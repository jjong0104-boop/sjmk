<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>사장마켓 간편신청</title>
  <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>

  <style>
    * { box-sizing: border-box; font-family: "Noto Sans KR", sans-serif; }
    body {
      background: #f6f6f6;
      margin: 0; padding: 0;
      display: flex; justify-content: center;
    }
    .form-container {
      width: 420px;
      background: #fff;
      padding: 32px 24px;
      border-radius: 20px;
      margin: 20px 0;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    h1 {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 24px;
      text-align: center;
    }

    label {
      display: block;
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .subtitle {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 16px;
      margin-top: 10px;
    }

    .option-btn {
      width: 100%; padding: 16px; margin-bottom: 12px;
      border-radius: 10px; border: 1.5px solid #ddd; text-align: center;
      background: #fff; font-size: 16px; cursor: pointer; transition: .2s;
    }
    .option-btn.selected {
      border-color: #EB3B00; background: #FFF5F2; color: #EB3B00; font-weight: 600;
    }

    input[type="text"], input[type="email"], input[type="date"], textarea {
      width: 100%; padding: 14px; font-size: 16px;
      border: 1.5px solid #ddd; border-radius: 10px;
      margin-bottom: 14px;
    }

    textarea {
      height: 80px; resize: none;
    }

    .btn {
      width: 100%; padding: 15px 0;
      background: #EB3B00; color: #fff;
      font-size: 16px; font-weight: 600;
      border: none; border-radius: 10px;
      margin-top: 10px; cursor: pointer;
    }
    .btn:hover { background: #d43200; }

    .step { display: none; }
    .step.active { display: block; }

    /* 약관 라벨 스타일 */
    .agree-row {
      display: flex; align-items: center; gap: 8px;
      margin-bottom: 8px;
    }
    .agree-row label {
      margin: 0;
      font-size: 16px;
      font-weight: 500;
    }
  </style>
</head>

<body>
  <div class="form-container">
    <h1>사장마켓 간편신청</h1>

    <!-- STEP 1 -->
    <div id="step1" class="step active">
      <div class="subtitle">패키지 선택</div>
      <div class="option-btn" onclick="selectPackage(this, 'CCTV 무료 패키지')">CCTV 무료 패키지</div>
      <div class="option-btn" onclick="selectPackage(this, 'POS 무료 패키지')">POS 무료 패키지</div>
      <div class="option-btn" onclick="selectPackage(this, '정수기 무료 패키지')">정수기 무료 패키지</div>
      <div class="option-btn" onclick="selectPackage(this, '기타 서비스')">기타 서비스</div>

      <button class="btn" onclick="nextStep(2)">다음</button>
    </div>

    <!-- STEP 2 -->
    <div id="step2" class="step">
      <div class="subtitle">설치 정보 입력</div>

      <label>오픈 예정일</label>
      <input type="date" id="openDate" required>

      <label>설치 주소</label>
      <div style="display:flex; gap:8px;">
        <input type="text" id="address" placeholder="주소찾기를 눌러 입력" readonly>
        <button type="button" onclick="searchAddress()" style="width:110px; background:#333;" class="btn">주소찾기</button>
      </div>

      <label>상세 주소</label>
      <input type="text" id="addressDetail" placeholder="상세 주소를 입력해주세요">

      <label>연락처</label>
      <input type="text" id="phone" placeholder="010-0000-0000">

      <label>가맹점/업체명</label>
      <input type="text" id="shopName" placeholder="가게명을 입력해주세요">

      <label>추가 문의사항</label>
      <textarea id="memo" placeholder="남기실 내용이 있다면 작성해주세요"></textarea>

      <button class="btn" onclick="nextStep(3)">다음</button>
    </div>

    <!-- STEP 3 -->
    <div id="step3" class="step">
      <div class="subtitle">약관 동의</div>

      <div class="agree-row">
        <input type="checkbox" id="privacyAgree">
        <label for="privacyAgree">개인정보 수집·이용에 동의합니다 (필수)</label>
      </div>

      <div class="agree-row">
        <input type="checkbox" id="marketingAgree">
        <label for="marketingAgree">마케팅 정보 수신 동의 (선택)</label>
      </div>

      <button class="btn" onclick="submitForm()">신청하기</button>
    </div>

  </div>

  <script>
    let selectedPackage = "";

    function selectPackage(el, value) {
      document.querySelectorAll(".option-btn").forEach(btn => btn.classList.remove("selected"));
      el.classList.add("selected");
      selectedPackage = value;
    }

    function nextStep(step) {
      document.querySelectorAll(".step").forEach(s => s.classList.remove("active"));
      document.getElementById(`step${step}`).classList.add("active");
    }

    function searchAddress() {
      new daum.Postcode({
        oncomplete: function(data) {
          document.getElementById("address").value = data.address;
        }
      }).open();
    }

    async function submitForm() {

      if (!selectedPackage) { alert("패키지를 선택해주세요."); return; }
      if (!document.getElementById("privacyAgree").checked) {
        alert("개인정보 수집·이용 동의는 필수입니다.");
        return;
      }

      const postData = {
        package: selectedPackage,
        openDate: document.getElementById("openDate").value,
        address: document.getElementById("address").value,
        addressDetail: document.getElementById("addressDetail").value,
        phone: document.getElementById("phone").value,
        shopName: document.getElementById("shopName").value,
        memo: document.getElementById("memo").value,
        privacyAgree: document.getElementById("privacyAgree").checked ? "동의" : "미동의",
        marketingAgree: document.getElementById("marketingAgree").checked ? "동의" : "미동의"
      };

      try {
        const res = await fetch("YOUR_WEBAPP_URL_HERE", {
          method: "POST",
          body: new URLSearchParams(postData)
        });

        const text = await res.text();
        if (text === "ok") {
          window.location.href = "?page=complete";
        } else {
          alert("전송 실패: " + text);
        }

      } catch (err) {
        alert("오류 발생: " + err);
      }
    }
  </script>
</body>
</html>
