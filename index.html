<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì‚¬ì¥ë§ˆì¼“ ê°„í¸ì‹ ì²­</title>
  <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>

  <style>
    * { box-sizing: border-box; font-family: "Noto Sans KR", sans-serif; }
    .step { display:none; }
    .step.active { display:block; }

    body {
      background: #f6f6f6;
      margin: 0; padding: 0;
      display: flex; justify-content: center;
    }

    .form-container {
      width: 420px;
      background: #fff;
      padding: 32px 24px;
      border-radius: 20px;
      margin: 20px 0;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    h1 {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 24px;
      text-align: center;
    }

    .subtitle {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 20px;
      margin-top: 10px;
    }

    label {
      display: block;
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .option-btn {
      width: 100%; padding: 16px; margin-bottom: 12px;
      border-radius: 10px; border: 1.5px solid #ddd; text-align: center;
      background: #fff; font-size: 16px; cursor: pointer; transition: .2s;
    }
    .option-btn.selected {
      border-color: #EB3B00; background: #FFF5F2; color: #EB3B00; font-weight: 600;
    }

    input[type="text"], input[type="email"], input[type="date"], textarea {
      width: 100%; padding: 14px; font-size: 16px;
      border: 1.5px solid #ddd; border-radius: 10px;
      margin-bottom: 14px;
    }
    textarea { height: 80px; resize: none; }

    .btn {
      width: 100%; padding: 15px 0;
      background: #EB3B00; color: #fff;
      font-size: 16px; font-weight: 600;
      border: none; border-radius: 10px;
      margin-top: 10px; cursor: pointer;
    }
    .btn:hover { background: #d43200; }

    .agree-box {
      border-top: 1px solid #eee;
      padding-top: 20px;
      margin-top: 10px;
    }

    .agree-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .agree-row label {
      font-size: 16px;
      font-weight: 500;
      margin: 0;
    }

    /* ì™„ë£Œ í˜ì´ì§€ */
    .complete-box {
      text-align: center;
      padding: 40px 20px;
    }

    .back-btn {
      margin-top: 20px;
      display: inline-block;
      padding: 14px 28px;
      background: #EB3B00;
      color: #fff;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      text-decoration: none;
    }
  </style>
</head>

<body>

  <!-- FORM ì˜ì—­ -->
  <div class="form-container" id="formPage">
    <h1>ì‚¬ì¥ë§ˆì¼“ ê°„í¸ì‹ ì²­</h1>

    <!-- STEP 1 -->
    <div id="step1" class="step active">
      <div class="subtitle">íŒ¨í‚¤ì§€ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”</div>
      <div class="option-btn" onclick="selectPackage(this, 'CCTV ë¬´ë£Œ íŒ¨í‚¤ì§€')">CCTV ë¬´ë£Œ íŒ¨í‚¤ì§€</div>
      <div class="option-btn" onclick="selectPackage(this, 'POS ë¬´ë£Œ íŒ¨í‚¤ì§€')">POS ë¬´ë£Œ íŒ¨í‚¤ì§€</div>
      <div class="option-btn" onclick="selectPackage(this, 'ì •ìˆ˜ê¸° ë¬´ë£Œ íŒ¨í‚¤ì§€')">ì •ìˆ˜ê¸° ë¬´ë£Œ íŒ¨í‚¤ì§€</div>
      <div class="option-btn" onclick="selectPackage(this, 'ê¸°íƒ€ ì„œë¹„ìŠ¤')">ê¸°íƒ€ ì„œë¹„ìŠ¤</div>
      <button class="btn" onclick="nextStep(2)">ë‹¤ìŒ</button>
    </div>

    <!-- STEP 2 -->
    <div id="step2" class="step">
      <div class="subtitle">ê¸°ë³¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</div>

      <label>ì´ë¦„</label>
      <input type="text" id="name" required>

      <label>ì˜¤í”ˆ ì˜ˆì •ì¼ *</label>
      <input type="date" id="openDate" required>

      <label>ì„¤ì¹˜ ì£¼ì†Œ *</label>
      <div style="display:flex; gap:8px;">
        <input type="text" id="address" placeholder="ì£¼ì†Œì°¾ê¸°ë¥¼ ëˆŒëŸ¬ ì…ë ¥" readonly required>
        <button type="button" onclick="searchAddress()" style="width:110px; background:#333;" class="btn">ì£¼ì†Œì°¾ê¸°</button>
      </div>

      <label>ìƒì„¸ ì£¼ì†Œ</label>
      <input type="text" id="addressDetail" placeholder="ìƒì„¸ ì£¼ì†Œ ì…ë ¥">

      <label>ì—°ë½ì²˜ *</label>
      <input type="text" id="phone" placeholder="010-0000-0000" required oninput="formatPhone(this)">

      <label>ìƒí˜¸ëª…</label>
      <input type="text" id="shopName" placeholder="ë§¤ì¥ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”(ì˜ˆì •ì¸ ê²½ìš° "ì˜ˆì •")ìœ¼ë¡œ">

      <label>ì¶”ê°€ ë¬¸ì˜ì‚¬í•­</label>
      <textarea id="memo" placeholder="ë‚¨ê¸°ì‹¤ ë‚´ìš©ì´ ìˆë‹¤ë©´ ì‘ì„±í•´ì£¼ì„¸ìš”"></textarea>

      <!-- ì•½ê´€ ë™ì˜ -->
      <div class="agree-box">
        <label style="font-size:18px; font-weight:700; margin-bottom:14px;">ì•½ê´€ ë™ì˜</label>

        <div class="agree-row">
          <input type="checkbox" id="privacyAgree">
          <label for="privacyAgree">ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš© ë™ì˜ (í•„ìˆ˜)</label>
        </div>

        <div class="agree-row">
          <input type="checkbox" id="marketingAgree">
          <label for="marketingAgree">ë§ˆì¼€íŒ… ì •ë³´ ìˆ˜ì‹  ë™ì˜ (ì„ íƒ)</label>
        </div>
      </div>

      <button class="btn" onclick="submitForm()">ì‹ ì²­í•˜ê¸°</button>
    </div>

  </div>

  <!-- COMPLETE PAGE -->
  <div class="form-container" id="completePage" style="display:none;">
    <div class="complete-box">
      <h1>ğŸ‰ ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!</h1>
      <p>ë‹´ë‹¹ìê°€ í™•ì¸ í›„ ë¹ ë¥¸ ì‹œì¼ë‚´ì— ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
      <a class="back-btn" href="">ì²˜ìŒìœ¼ë¡œ</a>
    </div>
  </div>

  <script>
    let selectedPackage = "";

    /** íŒ¨í‚¤ì§€ ì„ íƒ */
    function selectPackage(el, value) {
      document.querySelectorAll(".option-btn").forEach(btn => btn.classList.remove("selected"));
      el.classList.add("selected");
      selectedPackage = value;
    }

    /** STEP ì´ë™ */
    function nextStep(step) {
      if (step === 2) {
        if (!selectedPackage) {
          alert("íŒ¨í‚¤ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
          return;
        }
      }

      document.querySelectorAll(".step").forEach(s => s.classList.remove("active"));
      document.getElementById(`step${step}`).classList.add("active");
    }

    /** ì£¼ì†Œ ê²€ìƒ‰ */
    function searchAddress() {
      new daum.Postcode({
        oncomplete: function(data) {
          document.getElementById("address").value = data.address;
        }
      }).open();
    }

    /** ì „í™”ë²ˆí˜¸ ìë™ í¬ë§· */
    function formatPhone(input) {
      let val = input.value.replace(/[^0-9]/g, "");
      if (val.length > 3 && val.length <= 7)
        input.value = val.replace(/(\d{3})(\d{1,4})/, "$1-$2");
      else if (val.length > 7)
        input.value = val.replace(/(\d{3})(\d{4})(\d{1,4})/, "$1-$2-$3");
      else
        input.value = val;
    }

    /** ì œì¶œ */
    async function submitForm() {
      // í•„ìˆ˜ê°’ ì²´í¬
      if (!document.getElementById("openDate").value) return alert("ì˜¤í”ˆ ì˜ˆì •ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      if (!document.getElementById("address").value) return alert("ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      if (!document.getElementById("phone").value) return alert("ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");

      if (!document.getElementById("privacyAgree").checked) {
        alert("ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš© ë™ì˜ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.");
        return;
      }

      const postData = {
        package: selectedPackage,
        openDate: document.getElementById("openDate").value,
        address: document.getElementById("address").value,
        addressDetail: document.getElementById("addressDetail").value,
        phone: document.getElementById("phone").value,
        shopName: document.getElementById("shopName").value,
        memo: document.getElementById("memo").value,
        privacyAgree: document.getElementById("privacyAgree").checked ? "ë™ì˜" : "ë¯¸ë™ì˜",
        marketingAgree: document.getElementById("marketingAgree").checked ? "ë™ì˜" : "ë¯¸ë™ì˜"
      };

      try {
        const res = await fetch("https://script.google.com/macros/s/AKfycbzZyviKJtAHMzGC9IkZ5f3CNqKacBqF8DFOlGP0c2vxW6rgFVtdJiH8tsrO3Nae_3ntQQ/exec", {
          method: "POST",
          body: new URLSearchParams(postData)
        });

        const text = await res.text();
        if (text === "ok") {
          document.getElementById("formPage").style.display = "none";
          document.getElementById("completePage").style.display = "block";
        } else {
          alert("ì „ì†¡ ì‹¤íŒ¨: " + text);
        }

      } catch (err) {
        alert("ì˜¤ë¥˜ ë°œìƒ: " + err);
      }
    }

  </script>

</body>
</html>
